<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mkpenc.common.mapper.Dcc.DccAdminMapper">

    <select id="selectMemberTotalCnt" parameterType="DccSearchAdmin" resultType="int">
        SELECT
         COUNT(*) AS CNT 
        FROM MST_USER
		<trim prefix="WHERE" prefixOverrides="AND | OR">
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(userId)">
	            AND ID = #{userId}
	        </if>
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(userName)">
	            AND UserName LIKE '%' + #{userName} + '%'
	        </if>
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(groupCode)">
	            AND GroupCode = #{groupCode}
	        </if>        
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(useYN)">
	            AND UseYN = #{useYN}
	        </if>
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(login)">
	            AND Login = #{login}
	        </if>	        
        </trim>
    </select>

    <select id="selectMemberList" parameterType="DccSearchAdmin" resultType="MemberInfo">
        
        SELECT 
        		   A.* 
        		  , B.groupName
        FROM (
		        SELECT
		          ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rowNum
		          ,	ID        
				  ,  GroupCode 
				  ,  UserName  
				  ,  PWD         
				  ,  Login       
				  ,  LoginHogi  
				  ,  Email       
				  ,  Grade      
				  ,  userip      
				  , CONVERT(VARCHAR(19), conntime, 21) AS conntime
				  , CONVERT(VARCHAR(19), PwChTime, 21) AS PwChTime
				  , UseYN       
		        FROM MST_USER  WITH (NOLOCK)
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(userId)">
			            AND ID = #{userId}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(userName)">
			            AND UserName LIKE '%' + #{userName} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(groupCode)">
			            AND GroupCode = #{groupCode}
			        </if>        
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(useYN)">
			            AND UseYN = #{useYN}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(login)">
			            AND Login = #{login}
			        </if>
		        </trim>        
		        ORDER BY rowNum desc, GroupCode, PwChTime desc
		    	OFFSET (#{pageNum} - 1)  *  #{pageSize} ROWS
		    	FETCH NEXT #{pageSize} ROWS ONLY
		    	) A, MST_USER_GROUP B
	    WHERE A.groupCode = B.groupCode
    </select>
    
    <select id="selectMemberInfo" parameterType="DccSearchAdmin" resultType="MemberInfo">
        SELECT
         	ID        
		  ,  GroupCode 
		  ,  UserName  
		  ,  PWD         
		  ,  Login       
		  ,  LoginHogi  
		  ,  Email       
		  ,  Grade      
		  ,  userip      
		  ,  CONVERT(VARCHAR(19), conntime, 21) AS conntime
		  ,  CONVERT(VARCHAR(19), PwChTime, 21) AS PwChTime, USEYN 
		  ,  UseYN       
        FROM MST_USER
      	<trim prefix="WHERE" prefixOverrides="AND | OR">
        	 <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(userId)">
	            AND ID = #{userId}
    	    </if>
        	<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(userPwd)">
            	AND PWD = #{userPwd}
        	</if>
		</trim>       
    </select>    
    
    <insert id="insertMemberInfo" parameterType="DccSearchAdmin">
    		INSERT INTO MST_USER( ID, USERNAME, PWD, GROUPCODE, EMAIL, GRADE, LOGIN, LOGINHOGI, PWCHTIME, USEYN)
    		VALUES (#{iId}, #{iUserName}, #{iPwd}, #{iGroupCode}, #{iEmail}, #{iGrade}, 'N', #{iLoginHogi}, GETDATE(), #{iUseYN} )
    </insert>
    
	<update id="updateMemberInfo" parameterType="DccSearchAdmin">
    		UPDATE MST_USER
    		SET
    		<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(uPwd)">
    		   PWD = #{uPwd}
    		   , PWCHTIME = GETDATE() 
    		</if>
    		<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(uLogin)">
    		 	 LOGIN = #{uLogin}
    		 	 , USERIP = #{uUserIp}
    		 	 , CONNTIME = GETDATE() 
    		</if>
    		WHERE ID = #{uId}
    </update>
    
    <delete id="deleteMemberInfo" parameterType="DccSearchAdmin">
    		DELETE FROM MST_USER
    		WHERE ID = #{uId}
    </delete>
    
    <select id="selectMemberGroupCnt" resultType="int">
        SELECT
		   COUNT(*) AS CNT
        FROM MST_USER_GROUP
        <trim prefix="WHERE" prefixOverrides="AND | OR">
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(groupCode)">
	            AND GroupCode = #{groupCode}
	        </if>
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(groupName)">
	            AND GroupName = #{groupName}
	        </if>        
        </trim>        
    </select>
  
    <select id="selectMemberGroupCombo" resultType="MemberGroupInfo">
        SELECT
		    GroupCode 
		  ,  GroupName  
        FROM MST_USER_GROUP
        ORDER BY GroupCode
    </select>
    
    <select id="selectMemberGroupList" parameterType="DccSearchAdmin" resultType="MemberGroupInfo">
        SELECT
		    GroupCode 
		  ,  GroupName  
        FROM  MST_USER_GROUP WITH (NOLOCK)
		<trim prefix="WHERE" prefixOverrides="AND | OR">
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(groupCode)">
	            AND GroupCode = #{groupCode}
	        </if>
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(groupName)">
	            AND GroupName = #{groupName}
	        </if>        
        </trim>        
		ORDER BY GroupCode   
		OFFSET (#{grpPageNum} - 1)  *  #{grpPageSize} ROWS
	    FETCH NEXT #{grpPageSize} ROWS ONLY
    </select>
    
     <insert id="insertMemberGroupInfo" parameterType="DccSearchAdmin">
        INSERT INTO MST_USER_GROUP(GroupCode, GroupName)
        VALUES (#{groupCode}, #{groupName} )  
    </insert>
    
     <delete id="deleteMemberGroupInfo" parameterType="DccSearchAdmin">
        DELETE FROM MST_USER_GROUP
        WHERE GroupCode = #{groupCode}
          AND GroupName =  #{groupName}
    </delete>
    
    <select id="selectIOListInfoTotalCnt" parameterType="IOListInfo" resultType="int">
    			SELECT COUNT(*) AS CNT
				  FROM MST_TAG_DCC
				  <trim prefix="WHERE" prefixOverrides="AND | OR">
				         <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ihogi)">
				            AND IHOGI = #{ihogi}
				         </if>
				         <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(xygubun)">
				            AND XYGUBUN = #{xygubun}
				         </if>
				         <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iotype)">
			           		AND IOTYPE =#{iotype}
				         </if>
				          <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(address)">
				           		 AND ADDRESS LIKE '%' + #{address} + '%'
				        </if>  
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
						        AND  DESCR LIKE '%' + #{descr} + '%'
						</if>						
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(message)">						        
								AND MESSAGE LIKE '%' + #{message} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rev)">		
								AND REV LIKE '%' + #{rev} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(drawing)">		
								AND DRAWING LIKE '%' + #{drawing} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(loopname)">		
								AND LOOPNAME LIKE '%' + #{loopname} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(device)">		
								AND DEVICE LIKE '%' + #{device} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(purpose)">		
								AND PURPOSE LIKE '%' + #{purpose} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(program)">		
								AND PROGRAM LIKE '%' + #{program} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(vlow)">		
								AND VLOW LIKE '%' + #{vlow} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(vhigh)">	
								AND VHIGH LIKE '%' + #{vhigh} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(elow)">		
								AND ELOW LIKE '%' + #{elow} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ehigh)">		
								AND EHIGH LIKE '%' + #{ehigh} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(unit)">		
								AND UNIT LIKE '%' + #{unit} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(conv)">		
								AND CONV LIKE '%' + #{conv} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rtd)">		
								AND RTD LIKE '%' + #{rtd} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(type)">	
								AND TYPE LIKE '%' + #{type} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iogroup)">		
								AND IOGROUP LIKE '%' + #{iogroup} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(window)">		
								AND WINDOW LIKE '%' + #{window} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(priority)">	
								AND PRIORITY LIKE '%' + #{priority} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(cr)">	
								AND CR LIKE '%' + #{cr} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(limit1)">	
								AND LIMIT1 LIKE '%' + #{limit1} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(limit2)">	
								AND LIMIT2 LIKE '%' + #{limit2} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(j)">		
								AND J LIKE '%' + #{j} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(n)">		
								AND N LIKE '%' + #{n} + '%'
						</if>   
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(equ)">		
								AND EQU# LIKE '%' + #{equ} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(bscal)">		
								AND BSCAL LIKE '%' + #{bscal} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(wiba)">		
								AND WIBA LIKE '%' + #{wiba} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(wb)">		
								AND WB# LIKE '%' + #{wb} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ctrlname)">	
								AND CTRLNAME LIKE '%' + #{ctrlname} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(interlock)">		
								AND INTERLOCK LIKE '%' + #{interlock} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(feedback)">		
								AND FEEDBACK LIKE '%' + #{feedback} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(com1)">		
								AND COM1 LIKE '%' + #{com1} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(com2)">		
								AND COM2 LIKE '%' + #{com2} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(condition)">		
								AND CONDITION LIKE '%' + #{condition} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(tr)">		
								AND TR LIKE '%' + #{tr} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iobit)">		
								AND IOBIT LIKE '%' + #{iobit} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(alarmcond)">		
								AND ALARMCOND LIKE '%' + #{alarmcond} + '%'
						</if>   
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(indicate)">		
								AND INDICATE LIKE '%' + #{indicate} + '%'
				        </if>								
				</trim>        
	</select>
	
	<select id="selectIOListInfoList" parameterType="DccSearchAdmin" resultType="IOListInfo">
	
				SELECT IHOGI
				      , ISEQ
				      , IOTYPE
				      , ADDRESS
				      , IOBIT
				      , XYGUBUN
				      , LOOPNAME
				      , TBLNO
				      , FLDNO
				      , FILEPOSITION
				      , FASTIOCHK
				      , FEEDBACK
				      , REV
				      , DESCR
				      , PURPOSE
				      , VLOW
				      , VHIGH
				      , ELOW
				      , EHIGH
				      , UNIT
				      , CONV
				      , RTD
				      , REQUEST
				      , TYPE
				      , IOGROUP
				      , WINDOW
				      , PRIORITY
				      , TR
				      , CR
				      , LIMIT1
				      , LIMIT2
				      , J
				      , N
				      , MESSAGE
				      , EQU#
				      , BSCAL
				      , CAST(WIBA AS int) AS WIBA
				      , WB#
				      , AA#
				      , IOINDEX
				      , PROGRAM
				      , REVISION
				      , DEVICE
				      , CTRLNAME
				      , INTERLOCK
				      , ALARMCOND
				      , INDICATE
				      , COM1
				      , COM2
				      , DRAWING
				      , CONDITION
				      , IODATE
				      , MEASURENO
				      , OPERATIONVAR
				      , DRAWINGPOS
				      , RIGHTVAL
				      , NORMALVAL
				      , REQNO
				      , REQNAME
				      , REQDATE
				      , REQDEPT
				      , REQBIGO
				      , ZTEXT1
				      , ZTEXT2
				      , ZTEXT3
				  FROM MST_TAG_DCC 
				  <trim prefix="WHERE" prefixOverrides="AND | OR">
				         <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ihogi)">
				            AND IHOGI = #{ihogi}
				         </if>
				         <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(xygubun)">
				            AND XYGUBUN = #{xygubun}
				         </if>
				         <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iotype)">
			           		AND IOTYPE =#{iotype}
				         </if>
				          <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(address)">
				           		 AND ADDRESS LIKE '%' + #{address} + '%'
				        </if>  
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
						        AND  DESCR LIKE '%' + #{descr} + '%'
						</if>						
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(message)">						        
								AND MESSAGE LIKE '%' + #{message} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rev)">		
								AND REV LIKE '%' + #{rev} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(drawing)">		
								AND DRAWING LIKE '%' + #{drawing} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(loopname)">		
								AND LOOPNAME LIKE '%' + #{loopname} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(device)">		
								AND DEVICE LIKE '%' + #{device} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(purpose)">		
								AND PURPOSE LIKE '%' + #{purpose} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(program)">		
								AND PROGRAM LIKE '%' + #{program} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(vlow)">		
								AND VLOW LIKE '%' + #{vlow} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(vhigh)">	
								AND VHIGH LIKE '%' + #{vhigh} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(elow)">		
								AND ELOW LIKE '%' + #{elow} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ehigh)">		
								AND EHIGH LIKE '%' + #{ehigh} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(unit)">		
								AND UNIT LIKE '%' + #{unit} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(conv)">		
								AND CONV LIKE '%' + #{conv} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rtd)">		
								AND RTD LIKE '%' + #{rtd} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(type)">	
								AND TYPE LIKE '%' + #{type} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iogroup)">		
								AND IOGROUP LIKE '%' + #{iogroup} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(window)">		
								AND WINDOW LIKE '%' + #{window} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(priority)">	
								AND PRIORITY LIKE '%' + #{priority} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(cr)">	
								AND CR LIKE '%' + #{cr} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(limit1)">	
								AND LIMIT1 LIKE '%' + #{limit1} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(limit2)">	
								AND LIMIT2 LIKE '%' + #{limit2} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(j)">		
								AND J LIKE '%' + #{j} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(n)">		
								AND N LIKE '%' + #{n} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(equ)">		
								AND EQU# LIKE '%' + #{equ} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(bscal)">		
								AND BSCAL LIKE '%' + #{bscal} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(wiba)">		
								AND WIBA LIKE '%' + #{wiba} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(wb)">		
								AND WB# LIKE '%' + #{wb} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ctrlname)">	
								AND CTRLNAME LIKE '%' + #{ctrlname} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(interlock)">		
								AND INTERLOCK LIKE '%' + #{interlock} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(feedback)">		
								AND FEEDBACK LIKE '%' + #{feedback} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(com1)">		
								AND COM1 LIKE '%' + #{com1} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(com2)">		
								AND COM2 LIKE '%' + #{com2} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(condition)">		
								AND CONDITION LIKE '%' + #{condition} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(tr)">		
								AND TR LIKE '%' + #{tr} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iobit)">		
								AND IOBIT LIKE '%' + #{iobit} + '%'
						</if>   		
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(alarmcond)">		
								AND ALARMCOND LIKE '%' + #{alarmcond} + '%'
						</if>   
						<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(indicate)">		
								AND INDICATE LIKE '%' + #{indicate} + '%'
				        </if>
			       </trim>        
				    ORDER BY IHOGI desc, ISEQ desc	
	</select>
	
	<select id="selectIOListListInfo" parameterType="DccSearchAdmin" resultType="IOListInfo">
	
		SELECT IHOGI
				      , ISEQ
				      , IOTYPE
				      , ADDRESS
				      , IOBIT
				      , XYGUBUN
				      , LOOPNAME
				      , TBLNO
				      , FLDNO
				      , FILEPOSITION
				      , FASTIOCHK
				      , FEEDBACK
				      , REV
				      , DESCR
				      , PURPOSE
				      , VLOW
				      , VHIGH
				      , ELOW
				      , EHIGH
				      , UNIT
				      , CONV
				      , RTD
				      , REQUEST
				      , TYPE
				      , IOGROUP
				      , WINDOW
				      , PRIORITY
				      , TR
				      , CR
				      , LIMIT1
				      , LIMIT2
				      , J
				      , N
				      , MESSAGE
				      , EQU#
				      , BSCAL
				      , WIBA
				      , WB#
				      , AA#
				      , IOINDEX
				      , PROGRAM
				      , REVISION
				      , DEVICE
				      , CTRLNAME
				      , INTERLOCK
				      , ALARMCOND
				      , INDICATE
				      , COM1
				      , COM2
				      , DRAWING
				      , CONDITION
				      , IODATE
				      , MEASURENO
				      , OPERATIONVAR
				      , DRAWINGPOS
				      , RIGHTVAL
				      , NORMALVAL
				      , REQNO
				      , REQNAME
				      , REQDATE
				      , REQDEPT
				      , REQBIGO
				      , ZTEXT1
				      , ZTEXT2
				      , ZTEXT3
				  FROM MST_TAG_DCC 
				  <trim prefix="WHERE" prefixOverrides="AND | OR">
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ihogi)">
				            AND IHOGI = #{ihogi}
				        </if>
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(xyGubun)">
				            AND XYGUBUN = #{xyGubun}
				        </if>
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iseq)">
				            AND ISEQ = #{iseq}
				        </if>
				   </trim>
	</select>	
	
	<insert id="insertIOListInfo" parameterType="DccSearchAdmin" >
				INSERT INTO MST_TAG_DCC (
									  IHOGI 
									, ISEQ  
									, IOTYPE 
									, ADDRESS 
									, IOBIT 
									, XYGUBUN 
									, LOOPNAME 
									, TBLNO 
									, FLDNO 
									, FILEPOSITION 
									, FASTIOCHK , FEEDBACK
									, REV
									, DESCR 
									, PURPOSE 
									, VLOW 
									, VHIGH 
									, ELOW 
									, EHIGH 
									, UNIT 
									, CONV 
									, RTD 
									, REQUEST 
									, TYPE  
									, IOGROUP 
									, WINDOW 
									, PRIORITY 
									, TR 
									, CR 
									, LIMIT1 
									, LIMIT2 
									, J 
									, N 
									, MESSAGE 
									, EQU# 
									, BSCAL 
									, WIBA 
									, WB# 
									, IOINDEX 
									, PROGRAM 
									, REVISION 
									, DEVICE 
									, CTRLNAME 
									, INTERLOCK 
									, ALARMCOND 
									, INDICATE 
									, COM1 
									, COM2 
									, DRAWING 
									, CONDITION 
									, IODATE
									, MEASURENO 
									, OPERATIONVAR 
									, DRAWINGPOS 
									, RIGHTVAL 
									, NORMALVAL 
									, REQNO 
									, REQNAME 
									, REQDATE 
									, REQDEPT 
									, REQBIGO 
									, ZTEXT1 
									, ZTEXT2 
									, ZTEXT3
					) VALUES(	
										#{ihogi}
									  , (SELECT MAX(ISEQ) + 1 FROM  MST_TAG_DCC)
									  , #{iotype}
									  , #{address}
									  , #{iobit}
									  , #{loopname}
									  , #{tblno}
									  , #{fldno}
									  , #{fileposition}
									  , #{fastiochk}
									  , #{feedback}
									  , #{rev}
									  , #{descr}
									  , #{purpose}
									  , #{vlow}
									  , #{vhigh}
									  , #{elow}
									  , #{ehigh}
									  , #{unit}
									  , #{conv}
									  , #{rtd}
									  , #{request}
									  , #{type}
									  , #{iogroup}
									  , #{window}
									  , #{priority}
									  , #{tr}
									  , #{cr}
									  , #{limit1}
									  , #{limit2}
									  , #{j}
									  , #{n}
									  , #{message}
									  , #{equ}
									  , #{bscal}
									  , #{wiba}
									  , #{wb}
									  , #{ioindex}
									  , #{program}
									  , #{revision}
									  , #{device}
									  , #{ctrlname}
									  , #{interlock}
									  , #{alarmcond}
									  , #{indicate}
									  , #{com1}
									  , #{com2}
									  , #{drawing}
									  , #{condition}
									  , #{iodate}
									  , #{measureno}
									  , #{operationvar}
									  , #{drawingpos}
									  , #{rightval}
									  , #{normalval}
									  , #{reqno}
									  , #{reqname}
									  , #{reqdate}
									  , #{reqdept}
									  , #{reqbigo}
									  , #{ztext1}
									  , #{ztext2}
									  , #{ztext3}
								)
	</insert>	

	<update id="updateIOListInfo" parameterType="DccSearchAdmin" >
				UPDATE MST_TAG_DCC 
				  	SET                           
							  LOOPNAME =    #{loopname}
				  			  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(iobit)">                       
							  , IOBIT =  #{iobit}  
							  </if>
							  , TBLNO  = #{tblno}  
							  , FLDNO  = #{fldno}
							  , FILEPOSITION =  #{fileposition} 
							  , FASTIOCHK  = #{fastiochk} 
							  , FEEDBACK  = #{feedback} 
							  , REV  =  CONVERT(int, #{rev})
							  , DESCR  =  #{descr} 
							  , PURPOSE  =  #{purpose} 
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(vlow)">
							  , VLOW  = #{vlow} 
							  </if>
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(vhigh)">
							  , VHIGH  =  #{vhigh}
							  </if>
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(elow)">
							  , ELOW  =  #{elow}
							  </if>
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(ehigh)"> 
							  , EHIGH  =  #{ehigh} 
							  </if>
							  , UNIT  =  #{unit} 
							  , CONV  =  #{conv}                               
							  , RTD  =  #{rtd} 
							  , REQUEST  =   #{request} 
							  , TYPE   = #{type}
							  , IOGROUP  = #{iogroup}
							  , WINDOW  = #{window}
							  , PRIORITY  = #{priority}
							  , TR  =  #{tr}  
							  , CR  =  #{cr} 
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(limit1)">
							  , LIMIT1 =   #{limit1} 
							  </if>
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(limit2)">
							  , LIMIT2  = #{limit2} 
							  </if>
							  , J  = #{j}                          
							  , N  = #{n}
							  , MESSAGE =  #{message}
							  , EQU#  =  #{equ} 
							  , BSCAL  =  #{bscal}
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(wiba)">
							  , WIBA  =  #{wiba}
							  </if>
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(wb)">
							  , WB#  =  #{wb}  
							  </if>
							  <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(aa)">
							  , AA#  = #{aa}
							  </if>
							  , IOINDEX =   #{ioindex}  
							  , PROGRAM  = #{program}
							  , REVISION  = #{revision} 
							  , DEVICE  = #{device} 
							  , CTRLNAME =  #{ctrlname}  
							  , INTERLOCK  =  #{interlock} 
							  , ALARMCOND  = #{alarmcond}   
							  , INDICATE  =    #{indicate}  
							  , COM1  = #{com1}     
							  , COM2  =  #{com2}  
							  , DRAWING =    #{drawing}  
							  , CONDITION  =   #{condition}   
							  , IODATE =  #{iodate}     
							  , MEASURENO =    #{measureno}   
							  , OPERATIONVAR =   #{operationvar}    
							  , DRAWINGPOS  = #{drawingpos} 
							  , RIGHTVAL  =  #{rightval} 
							  , NORMALVAL  =  #{normalval}   
							  , REQNO  = #{reqno}   
							  , REQNAME  = #{reqname}    
							  , REQDATE  = #{reqdate} 
							  , REQDEPT  = #{reqdept}  
							  , REQBIGO  = #{reqbigo}  
							  , ZTEXT1  =  #{ztext1}
							  , ZTEXT2  = #{ztext2}
							  , ZTEXT3 = #{ztext3}
				  WHERE IHOGI = #{ihogi} 
				     AND ISEQ = #{iseq}
				     AND IOTYPE  = #{iotype}    
				     AND ADDRESS = #{address} 
			         <if test="iotype != 'CI' ">
			            AND XYGUBUN = #{xygubun}
			        </if>
				    
	</update>	
	
	<delete id="deleteIOListInfo" parameterType="DccSearchAdmin" >
				  DELETE FROM MST_TAG_DCC
				  WHERE IHOGI = #{ihogi} 
				     AND ISEQ = #{iseq}
				     AND XYGUBUN = #{xygubun}
	</delete>		
    
    <select id="selectImproveTotalCnt" parameterType="DccSearchAdmin" resultType="int">
        SELECT
        	COUNT(*) AS CNT
        FROM MST_IMPROVE
		<trim prefix="WHERE" prefixOverrides="AND | OR">
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(pTitle)">
	            AND PTITLE = #{pTitle}
	        </if>
	        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(pContents)">
	            AND PCONTENTS = #{pContents}
	        </if>        
        </trim>        
    </select>
    
	<select id="selectImproveList" parameterType="DccSearchAdmin" resultType="ImproveInfo">
        SELECT a.*, B.USERNAME
          FROM(
			        SELECT
			        	ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rowNum
			        	, SEQNO
						, PDATE
					    , PTITLE
					    , PCONTENTS
					    , PUSER
					    , WDATE
					    , WUSER
			        FROM MST_IMPROVE WITH (NOLOCK)
					<trim prefix="WHERE" prefixOverrides="AND | OR">
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(pTitle)">
				            AND PTITLE LIKE '%' + #{pTitle} + '%'
				        </if>
				        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(pContents)">
				            AND PCONTENTS LIKE '%' + #{pContents} + '%'
				        </if>        
			        </trim>        
					ORDER BY SEQNO desc
					OFFSET (#{grpPageNum} - 1)  *  #{grpPageSize} ROWS
				    FETCH NEXT #{grpPageSize} ROWS ONLY
	    ) A, MST_USER B
	    WHERE A.WUSER = B.ID
    </select>
    
    <insert id="insertImproveInfo" parameterType="DccSearchAdmin">
        INSERT INTO MST_IMPROVE(PDATE, PTITLE, PCONTENTS, PUSER, WDATE, WUSER)
        VALUES (GETDATE(), #{iPTitle}, #{iPContents}, #{iPUser}, GETDATE(), #{iWUser} )  
    </insert>
    
    <update id="updateImproveInfo" parameterType="DccSearchAdmin">
        UPDATE MST_IMPROVE
          SET 	PDATE =  GETDATE()
		          , PTITLE = #{iPTitle}
		          , PCONTENTS = #{iPContents}
		          , PUSER = #{iPUser}
         WHERE SEQNO = #{iSeqNo} 
    </update>    
    
     <delete id="deleteImproveInfo" parameterType="DccSearchAdmin">
        DELETE FROM MST_IMPROVE
        WHERE SEQNO = #{iSeqNo}
    </delete>
     
    <select id="selectSwSmTotalCnt" parameterType="DccSearchAdmin" resultType="int">
    		 SELECT COUNT(*) AS CNT
			  FROM MST_SW_SM
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(progName)">
			            AND PROGNAME LIKE '%' + #{descr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(logNo)">
			            AND LOGNO LIKE '%' + #{descr} + '%'
			        </if>
					<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
			            AND DESCR LIKE '%' + #{descr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(createDate)">
			            AND CREATEDATE LIKE '%' + #{descr} + '%'
			        </if>
		        </trim>        
    </select>
        
    <select id="selectSwSmList" parameterType="DccSearchAdmin" resultType="SwSmInfo">
			SELECT SEQNO
			      , LOGNO
			      , PRONO
			      , PROGNAME
			      , DIVIDE
			      , DESCR
			      , CREATEDATE
			      , HOGI
			      , BIGO
			      , FILENAME1
			      , FILENAME2
			      , FILENAME3
			      , FILENAME4
			      , FILENAME5
			      , FILENAME6
			      , FILENAME7
			      , FILENAME8
			      , FILENAME9
			      , FILENAME10
			  FROM MST_SW_SM  WITH (NOLOCK)
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(progName)">
			            AND PROGNAME LIKE '%' + #{progName} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(logNo)">
			            AND LOGNO LIKE '%' + #{logNo} + '%'
			        </if>
					<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
			            AND DESCR LIKE '%' + #{descr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(createDate)">
			            AND CREATEDATE LIKE '%' + #{createDate} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(seqNo)">
			            AND SEQNO = #{seqNo}
			        </if>
		        </trim>        
				ORDER BY SEQNO desc
		    	OFFSET (#{pageNum} - 1)  *  #{pageSize} ROWS
		    	FETCH NEXT #{pageSize} ROWS ONLY
    	</select>
    	
    	 <select id="selectSwSmExportList" parameterType="DccSearchAdmin" resultType="SwSmInfo">
			SELECT SEQNO
			      , LOGNO
			      , PRONO
			      , PROGNAME
			      , DIVIDE
			      , DESCR
			      , CREATEDATE
			      , HOGI
			      , BIGO
			      , FILENAME1
			      , FILENAME2
			      , FILENAME3
			      , FILENAME4
			      , FILENAME5
			      , FILENAME6
			      , FILENAME7
			      , FILENAME8
			      , FILENAME9
			      , FILENAME10
			  FROM MST_SW_SM
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(progName)">
			            AND PROGNAME LIKE '%' + #{progName} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(logNo)">
			            AND LOGNO LIKE '%' + #{logNo} + '%'
			        </if>
					<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
			            AND DESCR LIKE '%' + #{descr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(createDate)">
			            AND CREATEDATE LIKE '%' + #{createDate} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(seqNo)">
			            AND SEQNO = #{seqNo}
			        </if>
		        </trim>        
				ORDER BY SEQNO desc
    	</select>
    	
    	<select id="selectSwSmInfo" parameterType="DccSearchAdmin" resultType="SwSmInfo">
			SELECT SEQNO
			      , LOGNO
			      , PRONO
			      , PROGNAME
			      , DIVIDE
			      , DESCR
			      , CREATEDATE
			      , HOGI
			      , BIGO
			      , FILENAME1
			      , FILENAME2
			      , FILENAME3
			      , FILENAME4
			      , FILENAME5
			      , FILENAME6
			      , FILENAME7
			      , FILENAME8
			      , FILENAME9
			      , FILENAME10
			  FROM MST_SW_SM 
				<trim prefix="WHERE" prefixOverrides="AND | OR">			       
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(seqNo)">
			            AND SEQNO = #{seqNo}
			        </if>
		        </trim>        
    	</select>
    
     	<insert id="insertSwSmInfo" parameterType="DccSearchAdmin" >
		        INSERT INTO  MST_SW_SM (
		        		   SEQNO
					      , LOGNO
					      , PRONO
					      , PROGNAME
					      , DIVIDE
					      , DESCR
					      , CREATEDATE
					      , HOGI
					      , BIGO
					      , FILENAME1
					      , FILENAME2
					      , FILENAME3
					      , FILENAME4
					      , FILENAME5
					      , FILENAME6
					      , FILENAME7
					      , FILENAME8
					      , FILENAME9
					      , FILENAME10
				 )  VALUES (
				 		(SELECT MAX(SEQNO) + 1 FROM  MST_SW_SM)
				      , #{iLogNo} 
				      , #{iProNo}
				      , #{iProgName}
				      , #{iDivide}
				      , #{iDescr}
				      , #{iCreateDate}
				      , #{iHogi}
				      , #{iBigo}
				      , #{iFileName1}
				      , #{iFileName2}
				      , #{iFileName3}
				      , #{iFileName4}
				      , #{iFileName5}
				      , #{iFileName6}
				      , #{iFileName7}
				      , #{iFileName8}
				      , #{iFileName9}
				      , #{iFileName10}					      
				     )
	    </insert>
   
   		<delete id="deleteSwSmList" parameterType="DccSearchAdmin" >
		        DELETE FROM MST_SW_SM
		        WHERE SEQNO = #{seqNo}
	    </delete>
    
	    <select id="selectHwSmTotalCnt" parameterType="DccSearchAdmin" resultType="int">
    		 	SELECT COUNT(*) AS CNT
				  FROM MST_HW_SM
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(hogi)">
			            AND Hogi = #{hogi} 
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(type)">
			            AND Type = #{type}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(failure)">
			            AND Failure LIKE '%' + #{failure} + '%'
			        </if>	
					<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(repair)">
			            AND Repair LIKE '%' + #{repair} + '%'
			        </if>		
		        </trim>        
    	</select>
    
    	<select id="selectHwSmList" parameterType="DccSearchAdmin" resultType="HwSmInfo">
				SELECT SeqNo
				      , Hogi
				      , Type
				      , Date
				      , Failure
				      , Repair
				  FROM MST_HW_SM  WITH (NOLOCK)
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(hogi)">
			            AND Hogi = #{descr} 
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(type)">
			            AND Type = #{type}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(failure)">
			            AND Failure LIKE '%' + #{failure} + '%'
			        </if>	
					<if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(repair)">
			            AND Repair LIKE '%' + #{repair} + '%'
			        </if>		
		        </trim>        
				ORDER BY SEQNO desc
		    	OFFSET (#{pageNum} - 1)  *  #{pageSize} ROWS
		    	FETCH NEXT #{pageSize} ROWS ONLY
    	</select>
    
     	<insert id="insertHwSmInfo" parameterType="DccSearchAdmin" >
		        INSERT INTO  MST_HW_SM (
					         Hogi
						      , Type
						      , Date
						      , Failure
						      , Repair
				 ) VALUES( 
				       #{iHogi} 
				      , #{iType}
				      , #{iDate}
				      , #{iFailure}
				      , #{iRepair}
				     )
	    </insert>
	    
     	<update id="updateHwSmInfo" parameterType="DccSearchAdmin" >
		        UPDATE MST_HW_SM 
		              SET
		                    Hogi = #{iHogi} 
						  , Type = #{iType}
						  , Date = #{iDate}
						  , Failure = #{iFailure}
						  , Repair = #{iRepair}
				  WHERE SEQNO = #{iSeqNo}
	    </update>	    
   
   		<delete id="deleteHwSmInfo" parameterType="DccSearchAdmin" >
		        DELETE FROM MST_HW_SM
		        WHERE SEQNO = #{iSeqNo}
	    </delete>
    
    
    	<select id="selectEquipTotalCnt" parameterType="DccSearchAdmin" resultType="int">
		        SELECT COUNT(*) AS CNT
				  FROM MST_EQUIP
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(invnr)">
			            AND INVNR LIKE '%' + #{invnr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(state)">
			            AND STATE LIKE '%' + #{state} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(materialNo)">
			            AND MATERIALNO LIKE '%' + #{materialNo} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(sn)">
			            AND SN LIKE '%' + #{en} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(sysNm)">
			            AND SYSNM LIKE '%' + #{sysnm} + '%'
			        </if>      
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rack)">
			            AND RACK LIKE '%' + #{rack} + '%'
			        </if>      
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(equipNm)">
			            AND EQUIPNM LIKE '%' + #{equipNm} + '%'
			        </if>                      
		        </trim>				
    </select>
    
    <select id="selectEquipList" parameterType="DccSearchAdmin" resultType="equipInfo">
		        SELECT SEQNO
				      , INVNR
				      , USERNM
				      , HOGI
				      , SYSNM
				      , INSLOC
				      , RACK
				      , FID
				      , SPV
				      , EQUIPNM
				      , TAGNO
				      , MATERIALNO
				      , QGRADE
				      , SGRADE
				      , SYEAR
				      , PRODUCT
				      , SUPPLIER
				      , PN
				      , SN
				      , REV
				      , PRODATE
				      , PO
				      , INDATE
				      , INCNT
				      , STATE
				      , WEAKPART
				      , WPARTNM
				      , PMNO
				      , PCDATE
				      , PCCYCLE
				      , ICTCYCLE
				      , CHGCYCLE
				      , CHKMETH
				      , CHKCYCLE
				      , INSDATE
				      , MDATE1
				      , MCONTENT1
				      , MBIGO1
				      , MDATE2
				      , MCONTENT2
				      , MBIGO2
				      , MDATE3
				      , MCONTENT3
				      , MBIGO3
				      , MDATE4
				      , MCONTENT4
				      , MBIGO4
				      , EDATE1
				      , ECONTENT1
				      , EBIGO1
				      , EDATE2
				      , ECONTENT2
				      , EBIGO2
				      , EDATE3
				      , ECONTENT3
				      , EBIGO3
				      , EDATE4
				      , ECONTENT4
				      , EBIGO4
				  FROM MST_EQUIP  WITH (NOLOCK)
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(invnr)">
			            AND INVNR LIKE '%' + #{invnr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(state)">
			            AND STATE LIKE '%' + #{state} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(materialNo)">
			            AND MATERIALNO LIKE '%' + #{materialNo} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(sn)">
			            AND SN LIKE '%' + #{en} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(sysNm)">
			            AND SYSNM LIKE '%' + #{sysnm} + '%'
			        </if>      
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rack)">
			            AND RACK LIKE '%' + #{rack} + '%'
			        </if>      
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(equipNm)">
			            AND EQUIPNM LIKE '%' + #{equipNm} + '%'
			        </if>                      
		        </trim>        
				ORDER BY SEQNO desc
		    	OFFSET (#{pageNum} - 1)  *  #{pageSize} ROWS
		    	FETCH NEXT #{pageSize} ROWS ONLY
    </select>
    
    <select id="selectEquipListForExcel" parameterType="DccSearchAdmin" resultType="equipInfo">
		        SELECT SEQNO
				      , INVNR
				      , USERNM
				      , HOGI
				      , SYSNM
				      , INSLOC
				      , RACK
				      , FID
				      , SPV
				      , EQUIPNM
				      , TAGNO
				      , MATERIALNO
				      , QGRADE
				      , SGRADE
				      , SYEAR
				      , PRODUCT
				      , SUPPLIER
				      , PN
				      , SN
				      , REV
				      , PRODATE
				      , PO
				      , INDATE
				      , INCNT
				      , STATE
				      , WEAKPART
				      , WPARTNM
				      , PMNO
				      , PCDATE
				      , PCCYCLE
				      , ICTCYCLE
				      , CHGCYCLE
				      , CHKMETH
				      , CHKCYCLE
				      , INSDATE
				      , MDATE1
				      , MCONTENT1
				      , MBIGO1
				      , MDATE2
				      , MCONTENT2
				      , MBIGO2
				      , MDATE3
				      , MCONTENT3
				      , MBIGO3
				      , MDATE4
				      , MCONTENT4
				      , MBIGO4
				      , EDATE1
				      , ECONTENT1
				      , EBIGO1
				      , EDATE2
				      , ECONTENT2
				      , EBIGO2
				      , EDATE3
				      , ECONTENT3
				      , EBIGO3
				      , EDATE4
				      , ECONTENT4
				      , EBIGO4
				  FROM MST_EQUIP
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(invnr)">
			            AND INVNR LIKE '%' + #{invnr} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(state)">
			            AND STATE #{state} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(materialNo)">
			            AND MATERIALNO LIKE '%' + #{materialNo} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(sn)">
			            AND SN LIKE '%' + #{sn} + '%'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(sysNm)">
			            AND SYSNM LIKE '%' + #{sysnm} + '%'
			        </if>      
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(rack)">
			            AND RACK LIKE '%' + #{rack} + '%'
			        </if>      
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(equipNm)">
			            AND EQUIPNM LIKE '%' + #{equipNm} + '%'
			        </if>                      
		        </trim>        
				ORDER BY SEQNO desc
    </select>
    
    <select id="selectEquipInfo" parameterType="DccSearchAdmin" resultType="equipInfo">
		        SELECT SEQNO
				      , INVNR
				      , USERNM
				      , HOGI
				      , SYSNM
				      , INSLOC
				      , RACK
				      , FID
				      , SPV
				      , EQUIPNM
				      , TAGNO
				      , MATERIALNO
				      , QGRADE
				      , SGRADE
				      , SYEAR
				      , PRODUCT
				      , SUPPLIER
				      , PN
				      , SN
				      , REV
				      , PRODATE
				      , PO
				      , INDATE
				      , INCNT
				      , STATE
				      , WEAKPART
				      , WPARTNM
				      , PMNO
				      , PCDATE
				      , PCCYCLE
				      , ICTCYCLE
				      , CHGCYCLE
				      , CHKMETH
				      , CHKCYCLE
				      , INSDATE
				      , MDATE1
				      , MCONTENT1
				      , MBIGO1
				      , MDATE2
				      , MCONTENT2
				      , MBIGO2
				      , MDATE3
				      , MCONTENT3
				      , MBIGO3
				      , MDATE4
				      , MCONTENT4
				      , MBIGO4
				      , EDATE1
				      , ECONTENT1
				      , EBIGO1
				      , EDATE2
				      , ECONTENT2
				      , EBIGO2
				      , EDATE3
				      , ECONTENT3
				      , EBIGO3
				      , EDATE4
				      , ECONTENT4
				      , EBIGO4
				  FROM MST_EQUIP
 				  WHERE SEQNO =  #{intSeqNo}
       
    </select>
    
    <insert id="insertEquipInfo" parameterType="DccSearchAdmin" >
		        INSERT INTO  MST_EQUIP(
		        	  SEQNO
				      , INVNR
				      , USERNM
				      , HOGI
				      , SYSNM
				      , INSLOC
				      , RACK
				      , FID
				      , SPV
				      , EQUIPNM
				      , TAGNO
				      , MATERIALNO
				      , QGRADE
				      , SGRADE
				      , SYEAR
				      , PRODUCT
				      , SUPPLIER
				      , PN
				      , SN
				      , REV
				      , PRODATE
				      , PO
				      , INDATE
				      , INCNT
				      , STATE
				      , WEAKPART
				      , WPARTNM
				      , PMNO
				      , PCDATE
				      , PCCYCLE
				      , ICTCYCLE
				      , CHGCYCLE
				      , CHKMETH
				      , CHKCYCLE
				      , INSDATE
				      , MDATE1
				      , MCONTENT1
				      , MBIGO1
				      , MDATE2
				      , MCONTENT2
				      , MBIGO2
				      , MDATE3
				      , MCONTENT3
				      , MBIGO3
				      , MDATE4
				      , MCONTENT4
				      , MBIGO4
				      , EDATE1
				      , ECONTENT1
				      , EBIGO1
				      , EDATE2
				      , ECONTENT2
				      , EBIGO2
				      , EDATE3
				      , ECONTENT3
				      , EBIGO3
				      , EDATE4
				      , ECONTENT4
				      , EBIGO4
				 ) VALUES( 
				 	(SELECT MAX(SEQNO) + 1 FROM  MST_EQUIP)
				      , #{iInvnr} 
				      , #{iUserNm}
				      , #{iHogi}
				      , #{iSysNm}
				      , #{iInsLoc}
				      , #{iRack}
				      , #{iFid}
				      , #{iSpv}
				      , #{iEquipNm}
				      , #{iTagNo}
				      , #{iMaterialNo}
				      , #{iQGrade}
				      , #{iSgRade}
				      , #{iSYear}
				      , #{iProduct}
				      , #{iSupplier}
				      , #{iPn}
				      , #{iSn}
				      , #{iRev}
				      , #{iProDate}
				      , #{iPo}
				      , #{iInDate}
				      , #{iInCnt}
				      , #{iState}
				      , #{iWeakPart}
				      , #{iWPartNm}
				      , #{iPmNo}
				      , #{iPcDate}
				      , #{iPcCycle}
				      , #{iIctCycle}
				      , #{iChgCycle}
				      , #{iChkMeth}
				      , #{iChkCycle}
				      , #{iInsDate}
				      , #{iMDate1}
				      , #{iMContent1}
				      , #{iMBigo1}
				      , #{iMDate2}
				      , #{iMContent2}
				      , #{iMBigo2}
				      , #{iMDate3}
				      , #{iMContent3}
				      , #{iMBigo3}
				      , #{iMDate4}
				      , #{iMContent4}
				      , #{iMBigo4}
				      , #{iEDate1}
				      , #{iEContent1}
				      , #{iEBigo1}
				      , #{iEDate2}
				      , #{iEContent2}
				      , #{iEBigo2}
				      , #{iEDate3}
				      , #{iEContent3}
				      , #{iEBigo3}
				      , #{iEDate4}
				      , #{iEContent4}
				      , #{iEBigo4}
				     )
	    </insert>
	    
	    <update id="updateEquipInfo" parameterType="DccSearchAdmin" >
		        UPDATE MST_EQUIP
		        	SET 
				       USERNM = #{uUserNm}
				      , HOGI = #{uHogi}
				      , SYSNM = #{uSysNm}
				      , INSLOC = #{uInsLoc}
				      , RACK = #{uRack}
				      , FID = #{uFid}
				      , SPV = #{uSpv}
				      , EQUIPNM = #{uEquipNm}
				      , TAGNO = #{uTagNo}
				      , MATERIALNO = #{uMaterialNo}
				      , QGRADE = #{uQGrade}
				      , SGRADE = #{uSGrade}
				      , SYEAR = #{uSYear}
				      , PRODUCT = #{uProduct}
				      , SUPPLIER = #{uSupplier}
				      , PN = #{uPn}
				      , SN = #{uSn}
				      , REV = #{uRev}
				      , PRODATE = #{uProDate}
				      , PO = #{uPo}
				      , INDATE = #{uInDate}
				      , INCNT = #{uInCnt}
				      , STATE = #{uState}
				      , WEAKPART = #{uWeakPart}
				      , WPARTNM = #{uWPartNm}
				      , PMNO = #{uPmNo}
				      , PCDATE = #{uPcDate}
				      , PCCYCLE = #{uPcCycle}
				      , ICTCYCLE = #{uIctCycle}
				      , CHGCYCLE = #{uChgCycle}
				      , CHKMETH = #{uChkMeth}
				      , CHKCYCLE = #{uChkCycle}
				      , INSDATE = #{uInsDate}
				      , MDATE1 = #{uMDate1}
				      , MCONTENT1 = #{uMContent1}
				      , MBIGO1 = #{uMBigo1}
				      , MDATE2 = #{uMDate2}
				      , MCONTENT2 = #{uMContent2}
				      , MBIGO2 = #{uMBigo2}
				      , MDATE3 = #{uMDate3}
				      , MCONTENT3 = #{uMContent2}
				      , MBIGO3 = #{uMBigo3}
				      , MDATE4 = #{uMDate4}
				      , MCONTENT4 = #{uMContent4}
				      , MBIGO4 = #{uMBigo4}
				      , EDATE1 = #{uEDate1}
				      , ECONTENT1 = #{uEContent1}
				      , EBIGO1 = #{uEBigo1}
				      , EDATE2 = #{uEDate2}
				      , ECONTENT2 = #{uEContent2}
				      , EBIGO2 = #{uEBigo2}
				      , EDATE3 = #{uEDate3}
				      , ECONTENT3 = #{uEContent3}
				      , EBIGO3 = #{uEBigo3}
				      , EDATE4 = #{uEDate4}
				      , ECONTENT4 = #{uEContent4}
				      , EBIGO4 = #{uEBigo4}
				     WHERE SEQNO = #{intSeqNo} 
				       AND INVNR =   #{uInvnr} 
	    </update>
   
   		<delete id="deleteEquipInfo" parameterType="DccSearchAdmin" >
		        DELETE FROM MST_EQUIP
		        WHERE SEQNO = #{intSeqNo}
		          AND INVNR = #{uInvnr} 
	    </delete>
	    
	    <select id="selectRestartCodeTotalCnt" parameterType="DccSearchAdmin" resultType="int">
		        SELECT COUNT(*) AS CNT
				  FROM MST_RESTART_CODE
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(hogi)">
			            AND Hogi = #{hogi}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(xyGubun)">
			            AND XYGubun = #{xyGubun}'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(type)">
			            AND Type = #{type}
			        </if>			        
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(restartCode)">
			            AND RestartCode = #{restartCode}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
			            AND Descr LIKE '%' + #{descr} + '%'
			        </if>
		        </trim>
		</select>
	    
		<select id="selectRestartCodeList" parameterType="DccSearchAdmin" resultType="restartCodeInfo">
		        SELECT  SeqNo
					      , Hogi
					      , XYGubun
					      , CONVERT(CHAR(10), CreateDate, 23) AS CreateDate
					      , Type
					      , RestartCode
					      , Descr
					      , FileName1
					      , FileName2
					      , FileName3
					      , FileName4
					      , FileName5
				  FROM MST_RESTART_CODE  WITH (NOLOCK)
				<trim prefix="WHERE" prefixOverrides="AND | OR">
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(hogi)">
			            AND Hogi = #{hogi}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(xyGubun)">
			            AND XYGubun = #{xyGubun}'
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(type)">
			            AND Type = #{type}
			        </if>			        
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(restartCode)">
			            AND RestartCode = #{restartCode}
			        </if>
			        <if test="@org.apache.commons.lang3.StringUtils@isNotEmpty(descr)">
			            AND Descr LIKE '%' + #{descr} + '%'
			        </if>
		        </trim>        
				ORDER BY SeqNo desc
		    	OFFSET (#{pageNum} - 1)  *  #{pageSize} ROWS
		    	FETCH NEXT #{pageSize} ROWS ONLY
    	</select>
    	
    	<select id="selectRestartCodeInfo" parameterType="DccSearchAdmin" resultType="restartCodeInfo">
		        SELECT  SeqNo
					      , Hogi
					      , XYGubun
					      , CONVERT(CHAR(10), CreateDate, 23) AS CreateDate
					      , Type
					      , RestartCode
					      , Descr
					      , FileName1
					      , FileName2
					      , FileName3
					      , FileName4
					      , FileName5
				  FROM MST_RESTART_CODE
			      Where SeqNo =#{intSeqNo}
    	</select>
    
     	<insert id="insertRestartCodeInfo" parameterType="DccSearchAdmin" >
		        INSERT INTO  MST_RESTART_CODE (
					      Hogi
					      , XYGubun
					      , CreateDate
					      , Type
					      , RestartCode
					      , Descr
					      , FileName1
					      , FileName2
					      , FileName3
					      , FileName4
					      , FileName5
				  ) VALUES( 
				       #{iHogi} 
				      , #{iXYGubun}
				      , #{iCreateDate}
				      , #{iType}
				      , #{iRestartCode}
				      , #{iDescr}
				      , #{iFileName1}
				      , #{iFileName2}
				      , #{iFileName3}
				      , #{iFileName4}
				      , #{iFileName5}				      
				     )
	    </insert>
	    
	    <update id="updateRestartCodeInfo" parameterType="DccSearchAdmin" >
		        UPDATE MST_RESTART_CODE 
		        	  SET 
					       Hogi  = #{iHogi}
					      , XYGubun =  #{iXYGubun}
					      , CreateDate = #{iCreateDate}
					      , Type = #{iType}
					      , RestartCode = #{iRestartCode}
					      , Descr = #i{Descr}
					      , FileName1 = #{iFileName1}
					      , FileName2 = #{iFileName2}
					      , FileName3 = #{iFileName3}
					      , FileName4 = #{iFileName4}
					      , FileName5 = #{iFileName5}
				  WHERE SEQNO = #{intSeqNo}
	    </update>
   
   		<delete id="deleteRestartCodeInfo" parameterType="DccSearchAdmin" >
		        DELETE FROM MST_RESTART_CODE
		        WHERE SEQNO = #{intSeqNo}
	    </delete>
   
    

</mapper>
